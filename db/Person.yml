table: people
relations:
  person_names:
    model: PersonName
    type: has_many    
  person_name:
    model: PersonName
    type: has_one
    where: .used = true  
    order: .id desc
  contacts:
    model: PersonContact
    type: has_many  
  email:
    model: Contact
    type: has_one
    through: PersonContact
    where: .type = 'Email'
    through_where: .used = true 
  phone:
    model: Contact
    type: has_one
    through: PersonContact
    where: .type = 'Phone'  
    through_where: .used = true  
presets:
  item:
    fields:
      - source: people.id
        type: int
        alias: id      
      - source: person_name
        type: preset
        alias: name
        nested_preset: PersonName.name
  card:
    fields:
      - source: people.id
        type: int
        alias: id
      - source: person_name
        type: preset
        alias: name
        nested_preset: PersonName.name
      - source: email
        type: preset
        alias: email
        nested_preset: Contact.item
      - source: phone
        type: preset
        alias: phone
        nested_preset: Contact.item       
  edit:
    fields:
      - source: people.id
        type: int
        alias: id
      - source: people.name
        type: string
        alias: name
      - source: person_names.used
        type: bool
        alias: used
      - source: person_names.id
        type: int
        alias: naming_id